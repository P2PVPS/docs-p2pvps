<div class="hd">
    <input id="search" type="search" placeholder="search" />
    <label><input id="show-desc" type="checkbox" /> Show Description</label>
</div>
<div class="bd">
    <div class="toc">
        
            <h3 class="toc-mod-title"><a href="1.Quick-Start_doc.html">1.Quick-Start</a></h3>
            <div class="toc-list">
                
            </div>
        
            <h3 class="toc-mod-title"><a href="2.Specifications_doc.html">2.Specifications</a></h3>
            <div class="toc-list">
                
                <a class="toc-item" href="2.Specifications_doc.html#Definitions">
                    <h4>Definitions</h4>
                    <span class="desc"><ul>
<li><em>Client</em> or <em>Device</em> includes IoT devices, servers, and anything in between. This term encompasses any device capable of running Docker and executing the
client software</li>
<li><em>Server</em> is an internet connected computer, with a domain name, capable of running the
Server Deployment Repository software.</li>
<li><em>Device Owners</em> are the owners of the Client devices.</li>
<li><em>Renters</em> are users who rent the Client device from the Device Owners.</li>
</ul></span>
                </a>
                
                <a class="toc-item" href="2.Specifications_doc.html#Client-Overview">
                    <h4>Client-Overview</h4>
                    <span class="desc">The purpose of the client side software is to create a virtual private server (<strong>VPS</strong>) environment similar to those hosted by cloud companies like Digital
Ocean or AWS EC2. This is achieved on an IoT device by running a Linux shell inside
a Docker container. Small, inexpensive, distributed hardware like Raspberry Pi
minicomputers now posses the computational power to host such an environment.
So can Virtual Machines created by VirtualBox.</span>
                </a>
                
                <a class="toc-item" href="2.Specifications_doc.html#Server-Overview">
                    <h4>Server-Overview</h4>
                    <span class="desc">The primary purpose of the server software is to orchestrate the network of devices and facilitate financial transactions via OpenBazaar.
Its secondary purpose is to connect with other servers, in order to establish a
peer-to-peer (P2P) marketplace, with no central point of failure. These goals are
achieved by splitting the server into two software stacks: The <em>front end</em> and
the <em>back end</em>.</span>
                </a>
                
                <a class="toc-item" href="2.Specifications_doc.html#Server-Deployment-Overview">
                    <h4>Server-Deployment-Overview</h4>
                    <span class="desc">The Server Deployment repository is primarily concerned with helping people start up their own P2P VPS marketplace by easily deploying the software onto a Linux cloud
server. This is accomplished by modularizing the major pieces of software into Docker
containers and then orchestrating their communication with Docker Compose. It is
made up of the following high level features:</span>
                </a>
                
                <a class="toc-item" href="2.Specifications_doc.html#High-Level-Workflow">
                    <h4>High-Level-Workflow</h4>
                    <span class="desc">The sections below give additional details on how the system-as-a-whole works. Lower level specifications will be captured in the respective specification
document for Client, Server, and Server Deployment.</span>
                </a>
                
            </div>
        
            <h3 class="toc-mod-title"><a href="3.Client_doc.html">3.Client</a></h3>
            <div class="toc-list">
                
                <a class="toc-item" href="3.Client_doc.html#Governor-">
                    <h4>Governor-(p2p-vps-client.js)</h4>
                    <span class="desc">The primary purpose of the governor software is to manage the Docker container and communicate with the P2P VPS server. This application runs on the host operating system, outside the
Docker container. It plays the following roles:
<ul>
<li>It reads the <code>device-config.json</code> file and registers the Client device with the P2P VPS server.</li>
<li>It builds the Docker container with information returned by the server after registration.</li>
<li>It launches the Docker container after being built.</li>
<li>It sends a heartbeat signal to the P2P VPS server every 10 minutes. The server responds with an expiration date.</li>
<li>When the expiration date is reached, the governor software stops the Docker container and wipes the flash drive.
It then reregisters itself with the P2P VPS server.</li>
</ul></span>
                </a>
                
                <a class="toc-item" href="3.Client_doc.html#Docker-Container">
                    <h4>Docker-Container</h4>
                    <span class="desc">A Docker container is generated by the <code>p2p-vps-client.js</code> governor application. The Owner initiates the creation of the Docker container by registering the device
in the Device Management Dashboard. They are given a GUID, which they
then copy to the file <code>device-config.json</code>. The application <code>p2p-vps-client.js</code>
reads this file and makes a REST API call to the server to register itself.</span>
                </a>
                
                <a class="toc-item" href="3.Client_doc.html#Persistent-Storage">
                    <h4>Persistent-Storage</h4>
                    <span class="desc">Persistent storage can take many forms, but a USB flash drive will be encouraged, as SD cards have shown reliability issues. Most IoT devices, like the Raspberry
Pi can boot off an SD card. Extra storage can
easily be accommodated through USB flash drives or even USB external hard drives.
64GB Flash drives will be a (rough) standard due to their availability and low prices.</span>
                </a>
                
                <a class="toc-item" href="3.Client_doc.html#Deployment-Packages">
                    <h4>Deployment-Packages</h4>
                    <span class="desc">A collection of scripts will be made available to renters. These are preconfigured shell scripts or some other type of package manager that allows
them to quickly deploy common web services like NextCloud, a blog, a webserver,
a single page application development environment, a TOR node, an OpenBazaar
server, VPN software, etc. Easy scripts to deploy many of
these use cases.</span>
                </a>
                
                <a class="toc-item" href="3.Client_doc.html#Testing">
                    <h4>Testing</h4>
                    <span class="desc">Unit testing is initially planning to use Mocha, but we could use any platform at this stage. We could really use help with getting a solid unit testing library
in place for Client software. Contact us if you'd
like to help with this effort.</span>
                </a>
                
            </div>
        
            <h3 class="toc-mod-title"><a href="4.Server_doc.html">4.Server</a></h3>
            <div class="toc-list">
                
                <a class="toc-item" href="4.Server_doc.html#Rental-Search-UI">
                    <h4>Rental-Search-UI</h4>
                    <span class="desc">The <em>Rental Listing</em> view allows users to quickly search and sort for devices on the network that meet their criteria. Text search will be available, as well
as filtering and sorting by metrics such as price, uptime, memory, diskspace, and
geographic location. These metrics will be automatically validated by software
running on the device whenever possible.</span>
                </a>
                
                <a class="toc-item" href="4.Server_doc.html#Device-Management-Dashboard-UI">
                    <h4>Device-Management-Dashboard-UI</h4>
                    <span class="desc">The <em>Owned Devices</em> view allows device owners to manage the devices subscribed to the P2P VPS server. It's primary features are:</span>
                </a>
                
                <a class="toc-item" href="4.Server_doc.html#Database">
                    <h4>Database</h4>
                    <span class="desc">MongoDB is the database used by the P2P VPS server.</span>
                </a>
                
                <a class="toc-item" href="4.Server_doc.html#REST-API">
                    <h4>REST-API</h4>
                    <span class="desc">The P2P VPS server is based off this Koa Boilerplate
for creating a REST API server.</span>
                </a>
                
                <a class="toc-item" href="4.Server_doc.html#OpenBazaar-Store">
                    <h4>OpenBazaar-Store</h4>
                    <span class="desc">Each P2P VPS server is also an OpenBazaar (<strong>OB</strong>) store. OB will be leveraged to handle the
transactions between Device Owners and Renters. When a Device Owner submits
their device to
the P2P VPS Marketplace, the Server will be responsible for generating a contract
on the OpenBazaar network. Renters then purchase the contract using their own
OpenBazaar application. Login and password for the rented device is passed to them
through the 'Fulfilled' stage of the ordering process.</span>
                </a>
                
                <a class="toc-item" href="4.Server_doc.html#Port-Control">
                    <h4>Port-Control</h4>
                    <span class="desc">This is a Database API that is used to manage a list of available SSH ports for making reverse SSH tunnel connections between the Server and Client devices.</span>
                </a>
                
                <a class="toc-item" href="4.Server_doc.html#Testing">
                    <h4>Testing</h4>
                    <span class="desc">Testing of the server code will be different from the standpoint <em>front end</em> and <em>back end</em>.</span>
                </a>
                
            </div>
        
            <h3 class="toc-mod-title"><a href="5.Server-Deployment_doc.html">5.Server-Deployment</a></h3>
            <div class="toc-list">
                
                <a class="toc-item" href="5.Server-Deployment_doc.html#Koa-API">
                    <h4>Koa-API</h4>
                    <span class="desc">This is the P2P VPS Server REST API described in the Server chapter. All other containers support
this primary container.</span>
                </a>
                
                <a class="toc-item" href="5.Server-Deployment_doc.html#MongoDB">
                    <h4>MongoDB</h4>
                    <span class="desc">P2P VPS uses the standard MongoDB Docker image hosted on Docker Hub.</span>
                </a>
                
                <a class="toc-item" href="5.Server-Deployment_doc.html#Listing-Manager">
                    <h4>Listing-Manager</h4>
                    <span class="desc">The listing manager automates the maintenance of OpenBazaar listings that would otherwise require a human. The
role of the Listing Manager can be understood best by this workflow illustration:</span>
                </a>
                
                <a class="toc-item" href="5.Server-Deployment_doc.html#OpenBazaar">
                    <h4>OpenBazaar</h4>
                    <span class="desc">The OpenBazaar store is contained in it's own Docker container. It uses the latest Dockerhub image of
the openbazaar-go server. The
server communicates with the store via the
OpenBazaar REST API, using the
openbazaar-node library.</span>
                </a>
                
                <a class="toc-item" href="5.Server-Deployment_doc.html#SSH-Server">
                    <h4>SSH-Server</h4>
                    <span class="desc">The SSH tunnel server will run inside its own Docker container. It is necessary to give user-level shell access in order to generate the reverse tunnel to the
client devices. Keeping the SSH server isolated to it's own Docker container
reduces the threat of giving out shell access.</span>
                </a>
                
                <a class="toc-item" href="5.Server-Deployment_doc.html#LocalTunnel">
                    <h4>LocalTunnel</h4>
                    <span class="desc">The LocalTunnel server is also responsible for establishing a subdomain (like <strong>abc</strong>.p2pvps.com) and proxying connections from port 80 (HTTP) or port
442 (HTTPS) to the rented device. The easiest way to do this is by leveraging
a LocalTunnel Server.</span>
                </a>
                
            </div>
        
            <h3 class="toc-mod-title"><a href="6.Server-Client-Interaction_doc.html">6.Server-Client-Interaction</a></h3>
            <div class="toc-list">
                
                <a class="toc-item" href="6.Server-Client-Interaction_doc.html#Client-Registration">
                    <h4>Client-Registration</h4>
                    <span class="desc">The first, most basic workflow is client registration. This is where the client device connects to the server, sets up it's Docker shell, and the server adds
the client to marketplace of available devices for rent.</span>
                </a>
                
                <a class="toc-item" href="6.Server-Client-Interaction_doc.html#Check-Expiration">
                    <h4>Check-Expiration</h4>
                    <span class="desc">The client device governor (<code>p2p-vps-client.js</code>) will periodically reach out to the server to check its expiration date.
When the client device has reached it's expiration, it will destroy the current
Docker container and wipe any persistent storage. It will then re-register
with the server by going through the client registration
workflow above.</span>
                </a>
                
                <a class="toc-item" href="6.Server-Client-Interaction_doc.html#Client-Check-In">
                    <h4>Client-Check-In</h4>
                    <span class="desc">The <code>connect-client.js</code> application running inside the Client Docker container is responsible for establishing a reverse SSH connection with the server. It is also
responsible for sending a heart beat (or check-in signal) to the server to indicate
that it is connected to the network, and the software inside the Docker container
is running correctly.</span>
                </a>
                
            </div>
        
            <h3 class="toc-mod-title"><a href="7.Listing-Manager_doc.html">7.Listing-Manager</a></h3>
            <div class="toc-list">
                
                <a class="toc-item" href="7.Listing-Manager_doc.html#Fulfill-Orders">
                    <h4>Fulfill-Orders</h4>
                    <span class="desc">This is the primary task of the Listing Manager. It periodically polls the OpenBazaar store for new order notifications. If one is detected, the Listing Manager adds the
login, password, and port information to the order and then marks it as Fulfilled.</span>
                </a>
                
                <a class="toc-item" href="7.Listing-Manager_doc.html#Delist-Disconnected-Clients">
                    <h4>Delist-Disconnected-Clients</h4>
                    <span class="desc">If a <em>client listed for rent on the OpenBazaar store</em> fails to check in with the server after some grace period, it must
be considered in a disconnected state. The Listing Manager then removes the
rental listing from the OpenBazaar store.</span>
                </a>
                
                <a class="toc-item" href="7.Listing-Manager_doc.html#Detect-And-Refund-Disconnected-Rentals">
                    <h4>Detect-And-Refund-Disconnected-Rentals</h4>
                    <span class="desc">If a <em>client that is actively being rented</em> fails to check in with the server after some grace period, it must be considered in a disconnected state. The Listing Manager
resets the device (when it comes online) by manipulating the expiration date. It also
needs to automatically generate a pro-rated refund to the renter.</span>
                </a>
                
                <a class="toc-item" href="7.Listing-Manager_doc.html#Fulfill-Renewals">
                    <h4>Fulfill-Renewals</h4>
                    <span class="desc">In addition to polling the OpenBazaar store for new rental orders, the Listing Manager also needs to poll purchases of renewal contracts. This allows renters
to renew the rental agreement and continue using the rented Client.</span>
                </a>
                
                <a class="toc-item" href="7.Listing-Manager_doc.html#Remove-Orphaned-Renewals">
                    <h4>Remove-Orphaned-Renewals</h4>
                    <span class="desc">If a renewal listing hangs out on the OpenBazaar store for more than hour, it is considered 'orphaned'. In this case, the Listing Manager needs to remove that
listing from the OpenBazaar store.</span>
                </a>
                
            </div>
        
            <h3 class="toc-mod-title"><a href="y.Contributing_doc.html">y.Contributing</a></h3>
            <div class="toc-list">
                
            </div>
        
            <h3 class="toc-mod-title"><a href="z.Rough-Draft-Specs_doc.html">z.Rough-Draft-Specs</a></h3>
            <div class="toc-list">
                
                <a class="toc-item" href="z.Rough-Draft-Specs_doc.html#Rough-Draft-Specs">
                    <h4>Rough-Draft-Specs</h4>
                    <span class="desc"></span>
                </a>
                
            </div>
        
    </div>
</div>
